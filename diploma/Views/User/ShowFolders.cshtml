@using Microsoft.AspNetCore.Builder
@using Microsoft.AspNetCore.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.Extensions.Options

@inject IViewLocalizer Localizer
@inject IOptions<RequestLocalizationOptions> LocOptions
@{ ViewData["Title"] = "Моя папка";

    // получаем сервис IRequestCultureFeature
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    // получаем список поддерживаемых культур
    var cultureItems = LocOptions.Value.SupportedUICultures
        .Select(c => new SelectListItem { Value = c.Name, Text = c.NativeName })
        .ToList(); 
}
<style>
    .item {
        float: left;
    }

    .files {
        float: left;
    }

    .c-button {
        border: 2px solid transparent;
        /* другие стили */
        background: transparent;
        /*color: #ffffff;*/
        border-color: #000000;
        height: 40px;
        width: 128px;
    }
    /*
            .c-button:hover {
        background: transparent;
        color: #222;
        border-color: #4676d7;
    }
    */
</style>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>

<div class="container">
    <div class="files" style="margin-bottom: 10px;">
        <img src="~/images/folders_prev.png" style="width: 60px; height: 60px;" />
    </div>
    <div class="files">
        <p style="margin-left: 10px; margin-top: 4px; font-size: 18px; font-family: 'Gill Sans', sans-serif; "> <b> @Localizer["Label"] </b> </p>
        <p class="text-muted" style="margin-top: -15px; margin-left: 10px; font-size: 14px; font-family: 'Gill Sans', sans-serif;"> @Localizer["LabelDesr"] </p>
    </div>

    <div class="btn" style="float: right; font-family: 'Gill Sans', sans-serif; ">
        <button class="c-button" data-toggle="modal" data-target="#addFolder" style="border-radius:30px; margin-left: 15px; margin-bottom: 10px; margin-top: 10px;"> @Localizer["NewFolder"] </button>
    </div>

    <p>⠀⠀⠀⠀⠀⠀⠀⠀⠀</p>
    <p>⠀⠀⠀⠀⠀⠀⠀⠀⠀</p>

</div>

<p id="filesText" class="text-muted" style="display: none; margin-left:15px; margin-top:15px; font-size: 26px; font-family: 'Gill Sans', sans-serif; "> <b> @Localizer["Missing"] </b> </p>

<div id="dictOnly" style="display: inherit; font-family: 'Gill Sans', sans-serif; ">
    @foreach (System.Collections.Generic.KeyValuePair<string, string> fold in ViewBag.Dates)
    {
<div class="container" style="display: flex;">
    <a asp-action="FoldersFiles" asp-controller="User" asp-route-foldpath="@fold.Key" class="list-group-item list-group-item-action" style="width: 95%;">
        <div class="d-flex w-100 justify-content-between">
            <p class="mb-1"> <img src="~/images/folder_icon.png" style="width: 30px; height: 30px;"> @fold.Key.Substring(fold.Key.LastIndexOf("\\") + 1, fold.Key.LastIndexOf("_") - fold.Key.LastIndexOf("\\") - 1) </p>

        </div>
    </a>

    <div class="testcont" style="float: right; display: flex;">
        <div class="container" style="display: flex;">
            <a class="list-group-item list-group-item-action" style="width: 60px;">
                <div class="item one">
                    <input type="image" src="/images/edit-icon.png" name="@fold.Key" onclick="helper()" style="width: 25px; height: 25px; position: relative;" data-toggle="modal" data-target="#editFolder" />
                </div>
            </a>
        </div>

        <div class="container" style="display: flex; margin-left: -27px;">
            <a class="list-group-item list-group-item-action" style="width: 60px;">
                <div class="item two">
                    <input type="image" src="/images/delete-icon.png" id="delete" name="@fold.Key" onclick="check()" style="width: 25px; height: 25px; position: relative;" />
                </div>
            </a>
        </div>
    </div>
</div>}
</div>


<!-- модальное окно создания папки -->
<div id="addFolder" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"> @Localizer["CreateFolder"] </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label> @Localizer["Name"] </label>
                    <input type="text" id="resultName" class="form-control" />
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" onclick="add()"> @Localizer["Save"] </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"> @Localizer["Close"] </button>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- модальное окно редатикрования папки -->
<div id="editFolder" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"> Редактирование папки </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label> Название </label>
                    <input type="text" id="newName" class="form-control" />
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" onclick="edit()"> @Localizer["Save"] </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"> @Localizer["Close"] </button>
                </div>

            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    var mainPath;

    function helper(e) {
        mainPath = event.target.getAttribute("name");
    }

    var testValue = '@ViewBag.Dates';

    if (testValue != "System.Collections.Generic.Dictionary`2[System.String,System.String]") {
        var text = document.getElementById("filesText").style.display = "inherit";
    } else {

        @*var div = document.getElementById("dictOnly");
        var htmlCode = '@foreach (System.Collections.Generic.KeyValuePair<string, string> fold in ViewBag.Dates)
        { <div class="container" style="display: flex;"> <a asp-action="FoldersFiles" asp-controller="User" asp-route-foldpath="@fold.Key" class="list-group-item list-group-item-action" style="width: 95%;">  <div class="d-flex w-100 justify-content-between"> <p class="mb-1"> <img src="~/images/folder_icon.png" style="~/images/folder_icon.png" style="width: 30px; height: 30px;"> @fold.Key.Substring(fold.Key.LastIndexOf("\\") + 1, fold.Key.LastIndexOf("_") - fold.Key.LastIndexOf("\\") - 1) </p> <small class="text-muted"> @fold.Value </small> </div> </a> </div>} ';


        div.style.display = "inherit";

        div.innerHTML = htmlCode;*@

        var htmlCode = "@foreach (System.Collections.Generic.KeyValuePair<string, string> fold in ViewBag.Dates) { <p> @fold </p>} ";

    }

    function add() {

        $.ajax({
            url: '/User/AddDir',
            type: 'POST',
            contentType: false,
            processData: false,
            data: JSON.stringify($('#resultName').val()),
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                Swal.fire({
                    icon: "success",
                    title: "@Localizer["TitleSuccess"]",
                    text: "@Localizer["Success"]"
                });

                location.reload();

            },
            error: function () {
                Swal.fire({
                    icon: "error",
                    title: "@Localizer["TitleWrong"]",
                    text: "@Localizer["Verify"]"
                });
            }
        });
    }

    function check(e) {
        // вызвать метод аяк?

        helper(); // извлекаем путь файла

        $.ajax({
            url: '/User/DeleteDir',
            type: 'POST',
            contentType: false,
            processData: false,
            data: JSON.stringify(mainPath),
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                location.reload(); // перезагружаем страницу
            },
            error: function () {
                Swal.fire({
                    icon: "error",
                    title: "@Localizer["TitleDelete"]",
                    text: "@Localizer["Delete"]"
                });
            }
        });



    }

    function edit() {

        // mainPath - исходный путь редактируемой папки
        // #newName - новое название папки

        $.ajax({
            url: '/User/EditDir',
            type: 'POST',
            contentType: false,
            processData: false,
            data: JSON.stringify($('#newName').val() + '+' + mainPath),
            contentType: 'application/json; charset=utf-8',
            success: function (data) {

                Swal.fire({
                    icon: "success",
                    title: "Результаты получены!",
                    text: "Папка успешно переименована!"
                });

                setTimeout(location.reload(), 500);

            },
            error: function () {
                Swal.fire({
                    icon: "error",
                    title: "Что-то не так...",
                    text: "Проверьте правильность введенных данных"
                });
            }
        });

    }

</script>




